{"version":3,"sources":["../../src/services/auth.js"],"names":["router","express","Router","Keys","require","post","req","res","body","errors","isValid","status","json","payload","username","password","jwt","sign","secretOrKey","expiresIn","err","token","success","session"],"mappings":";;;;;;AAAA;;;;AACA;;;;AAMA;;;;;;AALA,IAAMA,SAASC,kBAAQC,MAAR,EAAf;;AAEA,IAAMC,OAAOC,QAAQ,gBAAR,CAAb;;AAEA;;;AAGA;AACAJ,OAAOK,IAAP,CAAY,QAAZ,EAAsB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAAA,4BACN,qBAAmBD,IAAIE,IAAvB,CADM;AAAA,MAC1BC,MAD0B,uBAC1BA,MAD0B;AAAA,MAClBC,OADkB,uBAClBA,OADkB;;AAGlC,MAAI,CAACA,OAAL,EAAc;AACZ,WAAOH,IAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBH,MAArB,CAAP;AACD;;AAED,MAAMI,UAAU;AACdC,cAAUR,IAAIE,IAAJ,CAASM,QADL;AAEdC,cAAUT,IAAIE,IAAJ,CAASO;AAFL,GAAhB;AAIA;AACAC,yBAAIC,IAAJ,CAASJ,OAAT,EAAkBV,KAAKe,WAAvB,EAAoC,EAAEC,WAAW,IAAb,EAApC,EAAyD,UAACC,GAAD,EAAMC,KAAN,EAAgB;AACvE,WAAOd,IAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BU,eAAS,IADiB;AAE1BC,eAAS,YAAYF;AAFK,KAArB,CAAP;AAID,GALD;AAMD,CAlBD;;kBAoBerB,M","file":"auth.js","sourcesContent":["import express from 'express';\nimport jwt from 'jsonwebtoken';\nconst router = express.Router();\n\nconst Keys = require('../config/keys');\n\n// Validation imports\nimport validateLoginInput from '../validation/login';\n\n// User sign in route\nrouter.post('/login', (req, res) => {\n  const { errors, isValid } = validateLoginInput(req.body);\n\n  if (!isValid) {\n    return res.status(400).json(errors);\n  }\n\n  const payload = {\n    username: req.body.username,\n    password: req.body.password\n  };\n  // Sign token\n  jwt.sign(payload, Keys.secretOrKey, { expiresIn: 3600 }, (err, token) => {\n    return res.status(200).json({\n      success: true,\n      session: 'Bearer ' + token\n    });\n  });\n});\n\nexport default router;\n"]}